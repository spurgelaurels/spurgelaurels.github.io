<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class="no-js">
<!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <title>DHCPD Fail - Arch – Spurge Laurels</title> <meta name="description" content="Petticoated Swashbuckler"> <meta name="keywords" content="arch, dhcp, linux"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="https://daphne-reed.io/assets/img/logo.png"> <meta name="twitter:title" content="DHCPD Fail - Arch"> <meta name="twitter:description" content="After deciding it was time to return to Linux on my workstation at home, and after an irritating battle with Ubuntu that I will detail in another post, I’ve ended up with Arch Linux installed to my platters again."> <meta name="twitter:site" content="@spurgelaurels"> <meta name="twitter:creator" content="@spurgelaurels"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="DHCPD Fail - Arch"> <meta property="og:description" content="After deciding it was time to return to Linux on my workstation at home, and after an irritating battle with Ubuntu that I will detail in another post, I’ve ended up with Arch Linux installed to my platters again."> <meta property="og:url" content="https://daphne-reed.io/dhcpd-fail-arch/"> <meta property="og:site_name" content="Spurge Laurels"> <meta property="og:image" content="https://daphne-reed.io/assets/img/logo.png"> <link rel="canonical" href="https://daphne-reed.io/dhcpd-fail-arch/"> <link href="https://daphne-reed.io/feed.xml" type="application/atom+xml" rel="alternate" title="Spurge Laurels Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="https://daphne-reed.io/assets/css/main.css"> <!-- JS --> <script src="https://daphne-reed.io/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="https://daphne-reed.io/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="https://daphne-reed.io/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="https://daphne-reed.io/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="https://daphne-reed.io/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="https://daphne-reed.io/favicon.png"> <link rel="shortcut icon" href="https://daphne-reed.io/favicon.ico"> <!-- Background Image --> <style type="text/css">body {background-image:url(https://daphne-reed.io/assets/img/winterTree.png); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-117258368-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-117258368-1'); </script> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="https://daphne-reed.io/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="https://daphne-reed.io/assets/img/logo.png" alt="Spurge Laurels photo" class="author-photo"> <h4>Spurge Laurels</h4> <p>Petticoated Swashbuckler</p> </li> <li><a href="https://daphne-reed.io/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="http://twitter.com/spurgelaurels" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a> </li> <li> <a href="http://facebook.com/daphnelydiareed" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-facebook-square"></i> Facebook</a> </li> <li> <a href="http://linkedin.com/in/spurgelaurels" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a> </li> <li> <a href="http://github.com/spurgelaurels" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> </ul>
<!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="https://daphne-reed.io/posts/">All Posts</a></li> <li><a href="https://daphne-reed.io/tags/">All Tags</a></li> </ul> </li> <li><a href="https://daphne-reed.io/projects/">Projects</a></li> </ul>
<!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>DHCPD Fail - Arch</h1> <h4>08 Jul 2013</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~2 minutes </p>
<!-- /.entry-reading-time --> <a class="btn zoombtn" href="https://daphne-reed.io/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <p>After deciding it was time to return to Linux on my workstation at home, and after an irritating battle with Ubuntu that I will detail in another post, I’ve ended up with Arch Linux installed to my platters again.</p> <p>I didn’t expect Arch Linux to install itself to my system, however, I also didn’t expect such a treat in configuring something as simple as DHCP. In short, it seemed that the dhcpcd service was timing out while waiting for another dependent service to start. This resulted in a completely booted system without an address from DHCP. Checking on the service status revealed the following error message:</p> <div class="highlighter-rouge"><pre class="highlight"><code>&lt;code&gt;sudo systemctl status dhcpcd@enp6s50.service
dhcpcd@enp6s50.service - dhcpcd on enp6s50
	  Loaded: loaded (/usr/lib/systemd/system/dhcpcd@.service; enabled)
	  Active: failed (Result: exit-code) since Wed, 2013-02-28 22:03:01 EST; 3min 32s ago
	 Process: 368 ExecStart=/sbin/dhcpcd -A -q -w %I (code=exited, status=1/FAILURE)
	  CGroup: name=systemd:/system/dhcpcd@.service/enp6s50
&lt;/code&gt;
</code></pre></div> <p>Recently, it seems that the Arch community has migrated to <a href="http://en.wikipedia.org/wiki/Systemd">systemd</a> as their init handling daemon. Services that are controlled by systemd are configured using a service file, for example, the dhcpcd.service file</p> <div class="highlighter-rouge"><pre class="highlight"><code>/usr/lib/systemd/system/dhcpcd@.service
</code></pre></div> <p>In this file, dependency chains are listed, as well as configuration options for the service daemons. It seems that an upstream service is taking too long to load, and dhcpcd doesn’t have a chance to grab an IP before the conch is taken away. We have a few options to fix this. First would be to rechain the entire dependency tree surrounding the dhcpcd service. This would take a while, and would possibly be completely wiped out the next time you upgrade your system. Not my favourite practice. Another would be to make sure that dhcpcd has enough time to grab an IP.</p> <p>Open up /usr/lib/systemd/system/dhcpcd@.service in your favourite editor. Under the [ExecStart] directive, we will want to add a timeout value (<em>-t 120</em>) high enough to allow enough wiggle room to let dhcpcd grab an IP. 120 seconds is way more than enough time. Keep in mind that this won’t force dhcpcd to /wait/ 120 seconds; it will exit as soon as it gets an IP address.</p> <div class="highlighter-rouge"><pre class="highlight"><code>&lt;code&gt;ExecStart=/sbin/dhcpcd -A -q -w %I &lt;strong&gt;-t 120&lt;/strong&gt;&lt;/code&gt;
</code></pre></div> <p>I’ve seen many other methods that attempted to resolve this issue, such as explicitly loading your network card module, scripting a manual start of dhcpcd near the end of the boot loading, or using dhclient instead. I found the above method to work like a charm, and if an update wipes it out, it’s a simple fix to add it back in there again.</p> <p>Now I patiently await the upstream fix.</p> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="https://daphne-reed.io/tags/#arch" title="Pages tagged arch" class="tag"><span class="term">arch</span></a><a href="https://daphne-reed.io/tags/#dhcp" title="Pages tagged dhcp" class="tag"><span class="term">dhcp</span></a><a href="https://daphne-reed.io/tags/#linux" title="Pages tagged linux" class="tag"><span class="term">linux</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=https://daphne-reed.io/dhcpd-fail-arch/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=https://daphne-reed.io/dhcpd-fail-arch/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=https://daphne-reed.io/dhcpd-fail-arch/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> <section id="disqus_thread" class="animated fadeInUp"></section><!-- /#disqus_thread --> </header> <!-- JS --> <script src="https://daphne-reed.io/assets/js/jquery-1.12.0.min.js"></script> <script src="https://daphne-reed.io/assets/js/jquery.dlmenu.min.js"></script> <script src="https://daphne-reed.io/assets/js/jquery.goup.min.js"></script> <script src="https://daphne-reed.io/assets/js/jquery.magnific-popup.min.js"></script> <script src="https://daphne-reed.io/assets/js/jquery.fitvid.min.js"></script> <script src="https://daphne-reed.io/assets/js/scripts.js"></script> <script type="text/javascript"> var disqus_shortname = 'spurgelaurels'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-117258368-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-117258368-1'); </script> </body> </html>
