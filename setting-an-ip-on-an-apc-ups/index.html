<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--><!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--><!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--><!--[if gt IE 8]><!--><html class="no-js">
<!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> <title>Setting an IP on an APC UPS – Spurge Laurels</title> <meta name="description" content="Petticoated Swashbuckler"> <meta name="keywords" content="computers, datacentre"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="https://daphne-reed.io/assets/img/logo.png"> <meta name="twitter:title" content="Setting an IP on an APC UPS"> <meta name="twitter:description" content="It is now 14:28 in the afternoon on a particularly busy day. Our power went off last night and our UPS (APC 1400XL with AP9617 management cards) all lost battery power before the building came back on. Today, I tasked myself with configuring our UPS to properly alert me, and perform a graceful shutdown on our servers."> <meta name="twitter:site" content="@spurgelaurels"> <meta name="twitter:creator" content="@spurgelaurels"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Setting an IP on an APC UPS"> <meta property="og:description" content="It is now 14:28 in the afternoon on a particularly busy day. Our power went off last night and our UPS (APC 1400XL with AP9617 management cards) all lost battery power before the building came back on. Today, I tasked myself with configuring our UPS to properly alert me, and perform a graceful shutdown on our servers."> <meta property="og:url" content="https://daphne-reed.io/setting-an-ip-on-an-apc-ups/"> <meta property="og:site_name" content="Spurge Laurels"> <meta property="og:image" content="https://daphne-reed.io/assets/img/logo.png"> <link rel="canonical" href="https://daphne-reed.io/setting-an-ip-on-an-apc-ups/"> <link href="https://daphne-reed.io/feed.xml" type="application/atom+xml" rel="alternate" title="Spurge Laurels Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="https://daphne-reed.io/assets/css/main.css"> <!-- JS --> <script src="https://daphne-reed.io/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="https://daphne-reed.io/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="https://daphne-reed.io/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="https://daphne-reed.io/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="https://daphne-reed.io/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="https://daphne-reed.io/favicon.png"> <link rel="shortcut icon" href="https://daphne-reed.io/favicon.ico"> <!-- Background Image --> <style type="text/css">body {background-image:url(https://daphne-reed.io/assets/img/winterTree.png); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-117258368-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-117258368-1'); </script> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="https://daphne-reed.io/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="https://daphne-reed.io/assets/img/logo.png" alt="Spurge Laurels photo" class="author-photo"> <h4>Spurge Laurels</h4> <p>Petticoated Swashbuckler</p> </li> <li><a href="https://daphne-reed.io/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="http://twitter.com/spurgelaurels" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a> </li> <li> <a href="http://facebook.com/daphnelydiareed" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-facebook-square"></i> Facebook</a> </li> <li> <a href="http://linkedin.com/in/spurgelaurels" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a> </li> <li> <a href="http://github.com/spurgelaurels" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> </ul>
<!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="https://daphne-reed.io/posts/">All Posts</a></li> <li><a href="https://daphne-reed.io/tags/">All Tags</a></li> </ul> </li> <li><a href="https://daphne-reed.io/projects/">Projects</a></li> </ul>
<!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>Setting an IP on an APC UPS</h1> <h4>25 Aug 2011</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~2 minutes </p>
<!-- /.entry-reading-time --> <a class="btn zoombtn" href="https://daphne-reed.io/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <p>It is now 14:28 in the afternoon on a particularly busy day. Our power went off last night and our UPS (APC 1400XL with AP9617 management cards) all lost battery power before the building came back on. Today, I tasked myself with configuring our UPS to properly alert me, and perform a graceful shutdown on our servers.</p> <h1 id="fails"><strong>Fails.</strong></h1> <p>I plugged the Network Management card into a network switch, and watched on the DHCP server for a request from an APC MAC address (00:C0:B7:xx:xx:xx by the way). Nothing showed up at first. I thought this would be no problem if I logged in over serial, so I grabbed an RS-232 cable and plugged it into the management port on the back of the UPS.</p> <p><strong>DO NOT EVER PLUG A NON-APC PROVIDED SERIAL CABLE INTO THE BACK OF AN APC UPS. THE UPS WILL SHUT DOWN WITHOUT ANY WARNING WHATSOEVER.</strong></p> <p><a href="/assets/img/oldblog/it-rage.jpg"><img src="/assets/img/oldblog/it-rage.jpg" alt=""></a></p> <p>So our UPS went down, taking out one of our Avaya IP Office modules (which was another problem to deal in its own right). What a great feature. Thanks APC.</p> <p>Once the UPS was running again, I tried in vain to reset the network card, try other cables, different ports on the switch. Finally and automagically, I could see the DHCP offer showing up in my logs. It would sit there for about 45 seconds before disappearing to try again. This is when I found out about Option 43.</p> <h1 id="option-43"><strong>Option 43</strong></h1> <p>Option 43 is a DHCP option for encapsulating vendor ID information into a DHCP response. For more information, read up on RFC2132, under section 8.4. In the case of an APC device, the hex code for this option would be 010431415043 (I know it looks like decimal, but trust me; it’s hex). This may work for you. Or in my case, it may not. APC uses this option as an authentication measure.</p> <h1 id="ping"><strong>PING!</strong></h1> <p>If none of the aforementioned solutions solved this problem for you, then you might have to resort to using ping.</p> <p>That’s right; I said PING.</p> <p>First, select an IP that’s unused on your network. Then create a local ARP entry with the MAC address of your device linked to that IP. Then, simply ping that IP with a packet size of 113 bytes.</p> <p><code class="highlighter-rouge"> [daphne@sixtee:~#] sudo arp -s 192.168.x.x 00:C0:B7:XX:XX:XX [daphne@sixtee:~#] ping 192.168.x.x -s 113 </code></p> <p>Seriously folks, I could not make this up.</p> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="https://daphne-reed.io/tags/#computers" title="Pages tagged computers" class="tag"><span class="term">computers</span></a><a href="https://daphne-reed.io/tags/#datacentre" title="Pages tagged datacentre" class="tag"><span class="term">datacentre</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=https://daphne-reed.io/setting-an-ip-on-an-apc-ups/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=https://daphne-reed.io/setting-an-ip-on-an-apc-ups/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=https://daphne-reed.io/setting-an-ip-on-an-apc-ups/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> <section id="disqus_thread" class="animated fadeInUp"></section><!-- /#disqus_thread --> </header> <!-- JS --> <script src="https://daphne-reed.io/assets/js/jquery-1.12.0.min.js"></script> <script src="https://daphne-reed.io/assets/js/jquery.dlmenu.min.js"></script> <script src="https://daphne-reed.io/assets/js/jquery.goup.min.js"></script> <script src="https://daphne-reed.io/assets/js/jquery.magnific-popup.min.js"></script> <script src="https://daphne-reed.io/assets/js/jquery.fitvid.min.js"></script> <script src="https://daphne-reed.io/assets/js/scripts.js"></script> <script type="text/javascript"> var disqus_shortname = 'spurgelaurels'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-117258368-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-117258368-1'); </script> </body> </html>
